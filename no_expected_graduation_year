-- This query will pull all current HS students who do not have an "Expected Graduation Year" in Illuminate.
-- This field should be filled with the year that a student would graduate high school given no retentions or extra promotions.
-- Use the "Mass Update Tool" to fill these fields.

SELECT
  ssc.site_id,
  stu.local_student_id,
  stu.last_name,
  stu.first_name,
  (ssc.grade_level_id - 1) as grade

FROM matviews.ss_current ssc

LEFT JOIN students stu on ssc.student_id = stu.student_id

WHERE
  ssc.site_id NOT IN (9999999,9999998)
  AND stu.expected_graduation_year IS NULL
  AND grade_level_id >= 10

ORDER BY
  site_id
  ,grade
